from datetime import datetime

from pydantic import BaseModel, validator

ETH_TOKEN_ADDRESS = "0xeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee"
KLAY_TOKEN_ADDRESS = "0x0000000000000000000000000000000000000000"

WETH_TOKEN_ADDRESS = "0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2"
WBTC_TOKEN_ADDRESS = "0x2260fac5e5542a773aa44fbcfedf7c193bc2c599"
LINK_TOKEN_ADDRESS = "0x514910771af9ca656af840dff83e8264ecf986ca"
YEARN_TOKEN_ADDRESS = "0x0bc529c00c6401aef6d220be8c6ea1667f6ad93e"
AAVE_TOKEN_ADDRESS = "0x7fc66500c84a76ad7e9c93437bfc5ac33e2ddae9"
UNI_TOKEN_ADDRESS = "0x1f9840a85d5af5bf1d1762f925bdaddc4201f984"
USDC_TOKEN_ADDRESS = "0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48"
DAI_TOKEN_ADDRESS = "0x6b175474e89094c44da98b954eedeac495271d0f"
REN_TOKEN_ADDRESS = "0x408e41876cccdc0f92210600ef50372656052a38"
CUSDC_TOKEN_ADDRESS = "0x39aa39c021dfbae8fac545936693ac917d5e7563"
CDAI_TOKEN_ADDRESS = "0x5d3a536e4d6dbd6114cc1ead35777bab948e3643"
CETH_TOKEN_ADDRESS = "0x4ddc2d193948926d02f9b1fe9e1daa0718270ed5"
CWBTC_TOKEN_ADDRESS = "0xc11b1268c1a384e55c48c2391d8d480264a3a7f4"
OUSDT_TOKEN_ADDRESS = "0xcee8faf64bb97a73bb51e115aa89c17ffa8dd167"
OUSDC_TOKEN_ADDRESS = "0x754288077d0ff82af7a5317c7cb8c444d421d103"
KDAI_TOKEN_ADDRESS = "0x5c74070fdea071359b86082bd9f9b3deaafbe32b"
KSD_TOKEN_ADDRESS = "0x4fa62f1f404188ce860c8f0041d6ac3765a72e67"
KCD_TOKEN_ADDRESS = "0x54640a6b9f5a6b0eae043f0a6fd69a4431323356"

WKLAY_TOKEN_ADDRESS = "0x19aac5f612f524b754ca7e7c41cbfa2e981a4432"
WKLAY_TOKEN_ADDRESS2 = "0xe4f05a66ec68b54a58b17c22107b02e0232cc817"
WKLAY_TOKEN_ADDRESS3 = "0xfd844c2fca5e595004b17615f891620d1cb9bbb2"
WKLAY_TOKEN_ADDRESS4 = "0x2ff5f6de2287ca3075232127277e53519a77947c"
WKLAY_TOKEN_ADDRESS5 = "0x57d1a61e4fd09fbf16e35b04959e94dcf2032974"
WKLAY_TOKEN_ADDRESS6 = "0xd7a4d10070a4f7bc2a015e78244ea137398c3b74"
WKLAY_TOKEN_ADDRESS7 = "0x5819b6af194a78511c79c85ea68d2377a7e9335f"
WKLAY_TOKEN_ADDRESS8 = "0x8dfbb066e2881c85749cce3d9ea5c7f1335b46ae"


KLAYTN_STABLE_TOKENS = [
    OUSDT_TOKEN_ADDRESS,
    OUSDC_TOKEN_ADDRESS,
    KDAI_TOKEN_ADDRESS,
    KSD_TOKEN_ADDRESS,
    KCD_TOKEN_ADDRESS,
]

KLAY_TOKEN_ADDRESSES = [
    KLAY_TOKEN_ADDRESS,
    WKLAY_TOKEN_ADDRESS,
    WKLAY_TOKEN_ADDRESS2,
    WKLAY_TOKEN_ADDRESS3,
    WKLAY_TOKEN_ADDRESS4,
    WKLAY_TOKEN_ADDRESS5,
    WKLAY_TOKEN_ADDRESS6,
    WKLAY_TOKEN_ADDRESS7,
    WKLAY_TOKEN_ADDRESS8,
]

TOKEN_ADDRESSES = [
    ETH_TOKEN_ADDRESS,
    KLAY_TOKEN_ADDRESS,
    WETH_TOKEN_ADDRESS,
    WBTC_TOKEN_ADDRESS,
    LINK_TOKEN_ADDRESS,
    YEARN_TOKEN_ADDRESS,
    AAVE_TOKEN_ADDRESS,
    UNI_TOKEN_ADDRESS,
    USDC_TOKEN_ADDRESS,
    DAI_TOKEN_ADDRESS,
    REN_TOKEN_ADDRESS,
    CUSDC_TOKEN_ADDRESS,
    CDAI_TOKEN_ADDRESS,
    CETH_TOKEN_ADDRESS,
    CWBTC_TOKEN_ADDRESS,
]

COINGECKO_ID_BY_ADDRESS = {
    WETH_TOKEN_ADDRESS: "weth",
    ETH_TOKEN_ADDRESS: "ethereum",
    KLAY_TOKEN_ADDRESS: "klay-token",
    WBTC_TOKEN_ADDRESS: "wrapped-bitcoin",
    LINK_TOKEN_ADDRESS: "chainlink",
    YEARN_TOKEN_ADDRESS: "yearn-finance",
    AAVE_TOKEN_ADDRESS: "aave",
    UNI_TOKEN_ADDRESS: "uniswap",
    USDC_TOKEN_ADDRESS: "usd-coin",
    DAI_TOKEN_ADDRESS: "dai",
    REN_TOKEN_ADDRESS: "republic-protocol",
    CUSDC_TOKEN_ADDRESS: "compound-usd-coin",
    CDAI_TOKEN_ADDRESS: "cdai",
    CETH_TOKEN_ADDRESS: "compound-ether",
    CWBTC_TOKEN_ADDRESS: "compound-wrapped-btc",
}


class Price(BaseModel):
    token_address: str
    usd_price: float
    timestamp: datetime

    @validator("token_address")
    def lower_token_address(cls, v: str) -> str:
        return v.lower()
